<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta xmlns="http://www.w3.org/1999/xhtml" charset="utf-8">
<meta xmlns="http://www.w3.org/1999/xhtml" name="viewport" content="width=device-width, initial-scale=1.0">
<meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="X-UA-Compatible" content="IE=edge">
<title>Automatic Meter Reading</title>
<script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
      {
      "@context": "http://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement":
      [{
          "@type": "ListItem",
          "position": 1,

          "item": {
          "@id": "../index.html",
          "name": "Communications Toolbox Support Package for Analog Devices ADALM-Pluto Radio"
}

          } 
        ,
        {
          "@type": "ListItem",
          "position": 2,

          "item": {
          "@id": "../application-specific-examples.html",
          "name": "Application-Specific"
}

          }]
      }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "VisibleBreadcrumbs",

        "itemListElement":
        [
        "application-specific-examples"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "DigitalDocument",
          "headline": "Automatic Meter Reading",
          "description": "Use Communications Toolbox&#8482; to read utility meters by processing Standard Consumption Message (SCM) signals and Interval Data Message (IDM) signals which are emitted by Encoder-Receiver-Transmitter (ERT) compatible meters. You can either use recorded data from a file, or receive over-the-air signals in real time using an RTL-SDR or ADALM-PLUTO radio.",
          "thumbnailURL": "../../../examples/comm/win64/amrExampleApp.png",
          "genre": "Script",
          "isBasedOn": {
          "@type": "Product",
          "name": "MATLAB"

        },
          "identifier": "comm.AMRExample",
          "name": "AMRExample",
          "url": "automatic-meter-reading.html"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "PropertyValue",
          "name": "open_command",
          "value": "matlab:openExample('comm/AMRExample')"

        }</script><script xmlns="http://www.w3.org/1999/xhtml" type="application/ld+json">
        {
        "@context": "http://schema.org",
        "@type": "ItemList",
          "name": "ExampleSourceFiles",

        "itemListElement":
        [
        "AMRExample.m",
        "amrExampleApp.png",
        "amrIDMPktFormat.png",
        "amrPHYRxFlow.png",
        "amrSCMPktFormat.png",
        "amr_capture_01.bb",
        "helperAMRConfig.m",
        "helperAMRInit.m",
        "helperAMRMessageParser.m",
        "helperAMRRxBitParser.m",
        "helperAMRRxDiscreteEvent.m",
        "helperAMRRxPHY.m",
        "helperAMRViewer.m",
        "AMRMultipleRadios.m",
        "amrExampleFlow.png",
        "ExampleSourceType.m",
        "AMRFieldNames.m",
        "AMRExampleApp.m",
        "helperAMRController.m",
        "runAMRReceiver.m"
        ],
        "itemListOrder": "http://schema.org/ItemListOrderAscending"
        }
        </script><link xmlns="http://www.w3.org/1999/xhtml" href="../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta xmlns="http://www.w3.org/1999/xhtml" http-equiv="Content-Script-Type" content="text/javascript">
<meta xmlns="http://www.w3.org/1999/xhtml" name="toctype" itemprop="pagetype" content="ug">
<meta xmlns="http://www.w3.org/1999/xhtml" name="infotype" itemprop="infotype" content="other">

<meta xmlns="http://www.w3.org/1999/xhtml" name="description" itemprop="description" content="This example shows you how to use Communications Toolbox&#8482; to read utility meters by processing Standard Consumption Message (SCM) signals and Interval Data Message (IDM) signals which are emitted by Encoder-Receiver-Transmitter (ERT) compatible meters."><meta xmlns="http://www.w3.org/1999/xhtml" content="../../../examples/comm/win64/amrExampleApp.png" itemprop="thumbnailUrl">
<script xmlns="http://www.w3.org/1999/xhtml" src="../includes/product/scripts/jquery/jquery-latest.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../includes/product/css/site6.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)">
<link xmlns="http://www.w3.org/1999/xhtml" href="../includes/product/css/site6_offcanvas_v2.css" rel="stylesheet" type="text/css">

<script xmlns="http://www.w3.org/1999/xhtml" src="../includes/shared/scripts/l10n.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../includes/shared/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../includes/shared/scripts/f1help.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../includes/product/scripts/docscripts.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../includes/shared/scripts/mw.imageanimation.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../includes/shared/scripts/jquery.highlight.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../includes/product/scripts/underscore-min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../includes/product/scripts/use_platform_screenshots.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../includes/product/scripts/suggest.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../includes/shared/scripts/overload.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../includes/shared/scripts/helpservices.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../includes/product/scripts/productfilter.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../includes/shared/scripts/product_group.js"></script><script xmlns="http://www.w3.org/1999/xhtml" src="../includes/shared/scripts/saxonjs/SaxonJS2.rt.js"></script><script xmlns="http://www.w3.org/1999/xhtml">
            window.history.replaceState(window.location.href, null, ""); // Initialize
            window.onload = function() {    
            mystylesheetLocation = "../includes/shared/scripts/product_group-sef.json";
            mysourceLocation = "../../../docset/docset.xml";
            product_help_location = "supportpkg/plutoradio";
            pagetype = "section";
            doccentertype = "product";
            langcode = "";
            getProductFilteredList(mystylesheetLocation, mysourceLocation, product_help_location, pagetype, doccentertype, langcode);  
            }
          </script>




<script xmlns="http://www.w3.org/1999/xhtml" src="../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../includes/product/scripts/bootstrap.min.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" src="../includes/product/scripts/global.js"></script>
<link xmlns="http://www.w3.org/1999/xhtml" href="../includes/product/css/doc_center_base.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link xmlns="http://www.w3.org/1999/xhtml" href="../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script xmlns="http://www.w3.org/1999/xhtml" src="../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div xmlns="http://www.w3.org/1999/xhtml" id="doc_header_spacer" class="header"></div>
<div xmlns="http://www.w3.org/1999/xhtml" class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-sm-6 col-md-7 has_horizontal_local_nav" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../../../documentation-center.html">Help Center</a></h1></div></div></div><div class="col-xs-12 col-sm-6 col-md-5" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2023a" data-language="en" action="../../../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="sr-only">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"> <div class="input-group-btn"><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="visible-xs" id="search_actuator"><button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div></div></div><div class="row-offcanvas row-offcanvas-left">
<div xmlns="http://www.w3.org/1999/xhtml" class="sidebar-offcanvas" id="sidebar">
<nav class="offcanvas_nav" role="navigation">
<div class="offcanvas_actuator" data-toggle="offcanvas" data-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="sr-only">Off-Canvas Navigation Menu Toggle
                  Off-Canvas Navigation Menu Toggle</span><span class="icon-menu"></span></button><span class="offcanvas_actuator_label" id="translation_icon-menu" tabindex="-1" aria-hidden="true"></span></div><div class="nav_list_wrapper" id="nav_list_wrapper"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" id="ul_left_nav_ancestors"><li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../../documentation-center.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Documentation Home</span></a></li></ul>
<ul class="nav_disambiguation"><li><a href="../index.html?s_tid=CRUX_lftnav">Communications Toolbox Support Package for Analog Devices ADALM-Pluto Radio</a>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../application-specific-examples.html?s_tid=CRUX_lftnav" itemprop="url"><span itemprop="title">Application-Specific</span></a></li></ul><ul class="nav_scrollspy nav">
<li class="nav_scrollspy_function"><a href="#responsive_offcanvas">Automatic Meter Reading</a></li>
<li class="nav_scrollspy_title" id="SSPY810-section">On this page</li>
<!--ADD_REFENTRY_TITLE_HERE 11--><li><a href="#d124e2971" class="intrnllnk">Required Hardware and Software</a></li><li><a href="#d124e2988" class="intrnllnk">Background</a></li><li><a href="#d124e3018" class="intrnllnk">Run Example</a></li><li><a href="#d124e3034" class="intrnllnk">Initialize Parameters</a></li><li><a href="#d124e3055" class="intrnllnk">Receiver Code Structure</a></li><li><a href="#d124e3116" class="intrnllnk">Further Exploration</a></li><li><a href="#d124e3155" class="intrnllnk">Selected Bibliography</a></li></ul>
</nav></div></nav>
<script src="../includes/product/scripts/offcanvas_v2.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="offcanvas_content_container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sticky_header_container"><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-sm-12 hidden-xs"><nav class="navbar navbar-default" role="navigation" id="subnav"><div><ul class="nav navbar-nav crux_browse"><li id="crux_nav_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_example" class="crux_resource"><a href="../examples.html?category=application-specific-examples&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=application-specific-examples&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_block" class="crux_resource"><a href="../referencelist.html?type=block&amp;category=application-specific-examples&amp;s_tid=CRUX_topnav">Blocks</a></li></ul></div></nav></div><div class="visible-xs"><div class="container-fluid"><div class="row"><div class="col-xs-9"><div class="mobile_crux_nav_trigger"><div class="btn-group"><button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Resources<span class="icon-arrow-down icon_16"></span></button><ul class="dropdown-menu"><li id="crux_nav_mobile_documentation" class="crux_resource active">Documentation</li><li id="crux_nav_mobile_example" class="crux_resource"><a href="../examples.html?category=application-specific-examples&amp;s_tid=CRUX_topnav">Examples</a></li><li id="crux_nav_mobile_function" class="crux_resource"><a href="../referencelist.html?type=function&amp;category=application-specific-examples&amp;s_tid=CRUX_topnav">Functions</a></li><li id="crux_nav_mobile_block" class="crux_resource"><a href="../referencelist.html?type=block&amp;category=application-specific-examples&amp;s_tid=CRUX_topnav">Blocks</a></li></ul></div></div></div><div class="col-xs-3"><div class="translate_placeholder"></div></div></div></div></div></div></div></div></div></div></div><div class="content_container" id="content_container" itemprop="content">
<div class="container-fluid">
<div class="row">
<div class="col-xs-12">

<div xmlns="http://www.w3.org/1999/xhtml" id="product_info_alert"></div><section xmlns="http://www.w3.org/1999/xhtml" id="doc_center_content" lang="en" data-language="en"><div id="pgtype-topic">
<section itemprop="content"><h1 class="r2023a" itemprop="title content" id="example-plutoradioAMRExample">Automatic Meter Reading</h1><div class="examples_short_list hidden_ios_android"><div data-pane="metadata" class="panel metadata_container panel-default"><div class="panel-body metadata_content"><p class="add_margin_5">This example uses:</p><ul class="list-unstyled add_border_bottom example_product_list" itemprop="requiredprods"><li><a href="matlab:matlab.internal.language.introspective.showAddon('CM')">Communications Toolbox</a></li><li><a href="matlab:matlab.internal.language.introspective.showAddon('PLUTO')">Communications Toolbox Support Package for Analog Devices ADALM-PLUTO Radio</a></li><li><a href="matlab:matlab.internal.language.introspective.showAddon('RTLSDR')">Communications Toolbox Support Package for RTL-SDR Radio</a></li></ul><a class="btn btn_secondary btn-block" href="matlab:openExample('comm/AMRExample')" data-ex-genre="Script">Open Script</a></div></div></div><div itemscope="" itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage/Example" itemprop="example" class="em_example"><meta itemprop="exampleid" content="comm-AMRExample"><meta itemprop="exampletitle" content="Automatic Meter Reading"></div><span id="AMRExample" class="anchor_target"></span>

<p class="shortdesc">This example shows you how to use Communications Toolbox&#8482; to read utility meters by processing Standard Consumption Message (SCM) signals and Interval Data Message (IDM) signals which are emitted by Encoder-Receiver-Transmitter (ERT) compatible meters. You can either use recorded data from a file, or receive over-the-air signals in real time using an RTL-SDR or ADALM-PLUTO radio.</p>

<p>In Simulink&#174;, you can explore the <a href="../../../comm/ug/automatic-meter-reading-in-simulink.html" data-docid="comm_ug#example-AMRSimulinkExample" class="a">Automatic Meter Reading in Simulink</a><span role="cross_prod"> (Communications Toolbox)</span> example.</p>

<div class="procedure"><h3 class="title" id="d124e2971">Required Hardware and Software<span id="AMRExample-1" class="anchor_target"></span></h3><p>To run this example using recorded data from a file, you need Communications Toolbox&#8482;.</p><p>To receive signals in real time, you also need one of these SDR devices and the corresponding software add-on:</p><div class="itemizedlist"><ul><li><p>RTL-SDR radio and the Communications Toolbox Support Package for RTL-SDR Radio add-on</p></li></ul></div><div class="itemizedlist"><ul><li><p>ADALM-PLUTO radio and the Communications Toolbox Support Package for Analog Devices&#174; ADALM-PLUTO Radio add-on</p></li></ul></div><p>For more information, see the <a href="https://www.mathworks.com/discovery/sdr.html" target="_blank"><span class="emphasis"><em>Software Defined Radio (SDR) discovery page</em></span></a>.</p><h3 class="title" id="d124e2988">Background<span id="AMRExample-2" class="anchor_target"></span></h3><p>Automatic Meter Reading (AMR) is a technology that autonomously collects the consumption and status data from utility meters (such as electric, gas, or water meters) and delivers the data to utility providers for billing or analysis purposes. The AMR system utilizes low power radio frequency (RF) communication to transmit meter readings to a remote receiver. The RF transmission properties include:</p><div class="itemizedlist"><ul><li><p>Transmission frequency within range: 910-920 MHz</p></li><li><p>Data rate: 32768 bps</p></li><li><p>On-off keyed Manchester coded signaling</p></li></ul></div><p>The SCM and IDM are two types of the conventional message types that the meters send out. The SCM packets are used with a fixed length of 96 bits, whereas IDM packets are used with a fixed length of 736 bits. These tables show the packet format of the SCM and IDM messages:</p><p></p>
<div class="informalfigure"><div id="d124e3003" class="mediaobject"><p><img src="../../../examples/comm/win64/xxamrSCMPktFormat.png"></p></div></div><p>
 </p><p></p>
<div class="informalfigure"><div id="d124e3009" class="mediaobject"><p><img src="../../../examples/comm/win64/xxamrIDMPktFormat.png"></p></div></div><p>
 </p><p>Meters capable of sending both SCM and IDM messages transmit them on the same channel with separation of roughly 275 msec. Each meter transmits the SCM and IDM messages over multiple frequencies using a hopping pattern. The actual transmission frequencies, the frequency hopping pattern, and the time interval between transmissions are random to avoid interference from other transmissions. For more information, see reference [ <a href="#AMRExample-12" class="intrnllnk">1</a> ].</p><h3 class="title" id="d124e3018">Run Example<span id="AMRExample-3" class="anchor_target"></span></h3><p>When you run the example:</p><div class="itemizedlist"><ul><li><p>The receiver initializes the simulation parameters and calculates the AMR parameters.</p></li><li><p>A data viewer display shows the meter ID, consumption information, and commodity type.</p></li><li><p>The simulation loop calls the signal source, physical layer, message parser, and data viewer.</p></li><li><p>The processing loop keeps track of the radio time using the frame duration.</p></li><li><p>The display updates for each data capture, showing unique meter IDs with the latest consumption information.</p></li></ul></div><h3 class="title" id="d124e3034">Initialize Parameters<span id="AMRExample-5" class="anchor_target"></span></h3><p>The default signal source is 'File', which runs the example using the recorded baseband signal file <code class="literal">amr_capture_01.bb</code>. To run the example using your RTL or ADALM-PLUTO SDR, change the setting for <code class="literal">signalSource</code> when you call the <a href="matlab:openExample('comm/AMRExample','supportingFile','helperAMRInit.m')" target="_blank">helperAMRInit.m</a> file. Valid options for <code class="literal">signalSource</code> are 'File', 'RTL-SDR', and 'ADALM-PLUTO'.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>signalSource = <span style="color:#A020F0">'File'</span>;
initParam = helperAMRInit(signalSource);

<span style="color:#228B22">% Calculate AMR system parameters based on the initialized parameters</span>
[amrParam,sigSrc] = helperAMRConfig(initParam);

<span style="color:#228B22">% Create the data viewer object</span>
viewer = helperAMRViewer(<span style="color:#A020F0">'MeterID'</span>,initParam.MeterID, <span style="color:#0000FF">...</span>
    <span style="color:#A020F0">'LogData'</span>,initParam.LogData, <span style="color:#0000FF">...</span>
    <span style="color:#A020F0">'LogFilename'</span>,initParam.LogFilename, <span style="color:#0000FF">...</span>
    <span style="color:#A020F0">'Fc'</span>,amrParam.CenterFrequency, <span style="color:#0000FF">...</span>
    <span style="color:#A020F0">'SignalSourceType'</span>,initParam.SignalSourceType);

start(viewer);
radioTime = 0; <span style="color:#228B22">% Initialize the radio time</span>

<span style="color:#228B22">% Main Processing Loop</span>
<span style="color:#0000FF">while</span> radioTime &lt; initParam.Duration
    rcvdSignal = sigSrc();
    amrBits = helperAMRRxPHY(rcvdSignal,amrParam);
    amrMessages = helperAMRMessageParser(amrBits,amrParam);
    update(viewer,amrMessages);
    radioTime = radioTime + amrParam.FrameDuration;
<span style="color:#0000FF">end</span>

stop(viewer); <span style="color:#228B22">% Stop the viewer</span>
release(sigSrc); <span style="color:#228B22">% Release the signal source</span>
</pre></div></div></div><div class="informalfigure"><div id="d124e3052" class="mediaobject"><p><img src="../../../examples/comm/win64/AMRExample_01.png"></p></div></div><h3 class="title" id="d124e3055">Receiver Code Structure<span id="AMRExample-6" class="anchor_target"></span></h3><p>The flow chart summarizes the receiver code structure. The processing has four main parts: Signal Source, Physical Layer, Message Parser and Data Viewer.</p><p></p>
<div class="informalfigure"><div id="d124e3062" class="mediaobject"><p><img src="../../../examples/comm/win64/xxamrExampleFlow.png"></p></div></div><p>
 </p><p><strong class="emphasis bold">Signal Source</strong></p><p>This example can use three signal sources:</p><div class="orderedlist"><ol style="list-style: decimal;"><li><p>''File'': Over-the-air signals written to a file and read using a <a href="../../../comm/ref/basebandfilereader.html" data-docid="comm_ref#bvb0lb6" class="a">Baseband File Reader</a><span role="cross_prod"> (Communications Toolbox)</span> object at 1.0 Msps</p></li><li><p>''RTL-SDR'': RTL-SDR radio at a sample rate of 1.0 Msps</p></li><li><p>''ADALM-PLUTO'': ADALM-PLUTO radio at a sample rate of 1.0 Msps</p></li></ol></div><p>If you assign ''RTL-SDR'' or ''ADALM-PLUTO'' as the signal source, the example searches your computer for the radio you specified, either an RTL-SDR radio at radio address '0' or an ADALM-PLUTO radio at radio address 'usb:0' and uses it as the signal source.</p><p><strong class="emphasis bold">Physical Layer</strong></p><p>The baseband samples received from the signal source are processed by the physical layer (PHY) to produce packets that contain the SCM or IDM information. This diagram shows the physical layer receive processing.</p><p></p>
<div class="informalfigure"><div id="d124e3087" class="mediaobject"><p><img src="../../../examples/comm/win64/xxamrPHYRxFlow.png"></p></div></div><p>
 </p><p>The RTL-SDR radio is capable of using a sampling rate in the range of 225-300 kHz or 900-2560 kHz. The ADALM-PLUTO radio is capable of using a sampling rate in the range of 520 kHz-61.44 MHz. A sampling rate of 1.0 Msps is used to produce a sufficient number of samples per Manchester encoded data bit. For each frequency in the hopping pattern, every AMR data packet is transmitted. The frequency hopping allows for increased reliability over time. Since every packet is transmitted on each frequency hop, it is sufficient to monitor only one frequency for this example. The radio is tuned to a center frequency of 915 MHz for the entire simulation runtime.</p><p>The received complex samples are amplitude demodulated by extracting their magnitude. The on-off keyed Manchester coding implies the bit selection block includes clock recovery. This block outputs bit sequences (ignoring the idle times in the transmission) which are subsequently checked for the known preamble. If the preamble matches, the bit sequence is further decoded, otherwise, it is discarded and the next sequence is processed.</p><p>When the known SCM preamble is found for a bit sequence, the received message bits are decoded using a shortened (255,239) BCH code which can correct up to two bit errors. In the case where the known IDM preamble is found, the receiver performs a cyclic redundancy check (CRC) of the meter serial number and of the whole packet starting at the Packet type (the 5th byte) to determine if the packet is valid. Valid, corrected messages are passed onto the AMR message parser.</p><p><strong class="emphasis bold">Message Parser</strong></p><p>For a valid message, the bits are then parsed into the specific fields of the SCM or the IDM format.</p><p><strong class="emphasis bold">Data Viewer</strong></p><p>The data viewer shows the decoded packets on a separate MATLAB&#174; figure. For each successfully decoded packet, the meter ID, commodity type, AMR packet type, consumption information and the capture time is shown. As data is captured and decoded, the application lists the information decoded from these messages in a tabular form. The table lists only the unique meter IDs with their latest consumption information.</p><p>You can also change the meter ID and start text file logging using the data viewer.</p><div class="itemizedlist"><ul><li><p><strong class="emphasis bold">Meter ID</strong> - Change the meter ID from 0, which is the default value and is reserved for displaying all detected meters, to a specific meter ID which you would like to be displayed.</p></li></ul></div><div class="itemizedlist"><ul><li><p><strong class="emphasis bold">Log data to file</strong> - Save the decoded messages in a TXT file. You can use the saved data for post processing.</p></li></ul></div><h3 class="title" id="d124e3116">Further Exploration<span id="AMRExample-11" class="anchor_target"></span></h3><p>The data file accompanying the example has only one meter reading and has been captured at center frequency of 915 MHz. Using RTL-SDR or ADALM-PLUTO, the example will display readings from multiple meters when it is run for a longer period in a residential neighborhood.</p><p>You can further explore AMR signals using the AMRExampleApp user interface. This app allows you to select the signal source and change the center frequency of the RTL-SDR or ADALM-PLUTO. This link launchs the <a href="matlab:openExample('comm/AMRExample','supportingFile','AMRExampleApp')" target="_blank">AMRExampleApp</a> app shown here.</p><p></p>
<div class="informalfigure"><div id="d124e3128" class="mediaobject"><p><img src="../../../examples/comm/win64/xxamrExampleApp.png"></p></div></div><p>
 </p><p>You can also explore the following functions for details of the physical layer, AMR message formats:</p><div class="itemizedlist"><ul><li><p><a href="matlab:openExample('comm/AMRExample','supportingFile','helperAMRRxPHY.m')" target="_blank">helperAMRRxPHY.m</a></p></li><li><p><a href="matlab:openExample('comm/AMRExample','supportingFile','helperAMRRxDiscreteEvent.m')" target="_blank">helperAMRRxDiscreteEvent.m</a></p></li><li><p><a href="matlab:openExample('comm/AMRExample','supportingFile','helperAMRRxBitParser.m')" target="_blank">helperAMRRxBitParser.m</a></p></li><li><p><a href="matlab:openExample('comm/AMRExample','supportingFile','helperAMRMessageParser.m')" target="_blank">helperAMRMessageParser.m</a></p></li></ul></div><p>For a version of the example that works with multiple radios, see <a href="matlab:openExample('comm/AMRExample','supportingFile','AMRMultipleRadios.m')" target="_blank">AMRMultipleRadios.m</a>. The multiple radio version allows you to examine the frequency hop patterns for a meter by setting different center frequencies per radio device available. The script is set for two radios, but can be extended for any number.</p><h3 class="title" id="d124e3155">Selected Bibliography<span id="AMRExample-12" class="anchor_target"></span></h3><div class="orderedlist"><ol style="list-style: decimal;"><li><p>Automatic meter reading, <a href="https://en.wikipedia.org/wiki/Encoder_receiver_transmitter" target="_blank">https://en.wikipedia.org/wiki/Encoder_receiver_transmitter</a>, 2016.</p></li><li><p>Itron Electricity meters, <a href="https://www.itron.com/solutions/who-we-serve/electricity" target="_blank">https://www.itron.com/solutions/who-we-serve/electricity</a>, 2017.</p></li></ol></div></div></section>
    </div>
<div class="modal fade" id="open-example-dialog" tabindex="-1" role="dialog" aria-labelledby="openExampleDialogLabel" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button><h2 class="h3 modal-title">Open Example</h2></div><div class="modal-body" id="dialog-body"><p>You have a modified version of this example. Do you want to open this example with your edits?</p></div><div class="modal-footer"><a id="open-example-dialog-replace" class="btn btn_color_blue companion_btn" data-dismiss="modal">No, open this example and discard my edits</a><a id="open-example-dialog-continue" class="btn btn_color_blue" data-dismiss="modal">Yes</a></div></div></div></div>
<div class="clearfix"></div>
<div align="center" class="feedbackblock" id="mw_docsurvey"><script src="https://www.mathworks.com/help/docsurvey/docfeedback.js"></script>
<script>loadSurveyHidden();</script>
<link rel="stylesheet" href="https://www.mathworks.com/help/docsurvey/release/index-css.css" type="text/css">
<script src="https://www.mathworks.com/help/docsurvey/release/bundle.index.js"></script>

<script>initDocSurvey();</script></div></section>


</div>
</div>
</div>
</div><!--close_0960-->
<footer xmlns="http://www.w3.org/1999/xhtml" id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-xs-12">
<p class="copyright">© 1994-2023 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="matlab:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="matlab:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="matlab:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="matlab:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</div><!--close_0970-->
</body>
</html>
